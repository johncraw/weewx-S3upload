# weewx-S3upload

This is a weewx extension to upload web files to an AWS S3 bucket.

Rather than serving the web pages generated by weewx directly from a 
webserver running on the same system as weewx, I upload those pages 
to an AWS S3 bucket. The bucket is configured to be a static website
and is costing me around USD 0.50/month. This is cheaper than usual 
website hosting and saves me the worry of someone hacking into the
system running weewx.

This has been tested against weewx 3.7.1 and s3cmd 2.0.1

## Setup

Before installing this extensions, get an S3 bucket at Amazon
https://aws.amazon.com/. Sign into the management consule, create an
account if necessary, then create an S3 bucket.

Search their help pages for how to set up the bucket as a static
website. You'll need to add a DNS record for the URL you choose for
accessing the bucket.

Install `s3cmd` from http://s3tools.org/s3cmd. It is a Python 2.x
tool so will run fine on the same computer as weewx.

Clone this repo; e.g. to your home directory

```
cd ~
git clone https://github.com/johncraw/weewx-S3upload.git
```

## Installation instructions

1. run the installer

  ```
  wee_extension --install ~/weewx-S3upload/
  ```

2. modify the S3upload stanza in weewx.conf and set your S3 access
code, secret token, and bucket name. You will get those when you set
up the bucket you want to use.

3. (re)start weewx:

  ```
  systemctl stop weewx
  systemctl start weewx
  ```

## Manual installation instructions:

1. copy files to the weewx user directory:

  ```
  cp -rp skins/S3upload /etc/weewx/skins
  cp -rp bin/user/S3upload /usr/share/weewx/user
  ```

2. add the following to weewx.con

  ```
  [StdReport]
      ...
      [[S3upload]]
          skin = S3upload
          acces_key = 'REPLACE_WITH_YOUR_S3_ACCESS_KEY'
          secret_token ='REPLACE_WITH_YOUR_SECRET_TOKEN'
          bucket_name = 'REPLACE_WITH_YOUR_S3_BUCKET_NAME'
  ```

3. (re)start weewx:

  ```
  systemctl stop weewx
  systemctl start weewx
  ```
